# Hermetic Server (Mockoon Mode): demo-service

## Overview

This hermetic server uses [Mockoon](https://mockoon.com/) to provide a lightweight, configurable mock API for testing. Mockoon allows you to define mock responses with data buckets for stateful testing.

### Key Features
- ✅ **No Code Required**: Configure via JSON files
- ✅ **Data Buckets**: Persistent test data within session
- ✅ **Templating**: Dynamic responses with Handlebars
- ✅ **Fast Startup**: Milliseconds to ready
- ✅ **Portable**: Run anywhere with Docker

## Quick Start

```bash
# Start with Docker Compose
docker-compose -f docker-compose.mockoon.yml up

# Or run Mockoon CLI directly
mockoon-cli start --data mockoon/environment.json --port 8080
```

## Available Entities
- User
- Order
- Product

## API Endpoints

### Health Check
```bash
curl http://localhost:8080/health
```

### User Endpoints
| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | /api/users | List all users |
| GET | /api/users/:id | Get User by ID |
| POST | /api/users | Create new User |
| PUT | /api/users/:id | Update User |
| DELETE | /api/users/:id | Delete User |

### Order Endpoints
| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | /api/orders | List all orders |
| GET | /api/orders/:id | Get Order by ID |
| POST | /api/orders | Create new Order |
| PUT | /api/orders/:id | Update Order |
| DELETE | /api/orders/:id | Delete Order |

### Product Endpoints
| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | /api/products | List all products |
| GET | /api/products/:id | Get Product by ID |
| POST | /api/products | Create new Product |
| PUT | /api/products/:id | Update Product |
| DELETE | /api/products/:id | Delete Product |

### Hermetic Control Endpoints

| Method | Endpoint | Description |
|--------|----------|-------------|
| POST | /hermetic/seedEntities | Seed test data |
| POST | /hermetic/reset | Reset to base state |
| GET | /hermetic/sample-data | List sample data types |
| GET | /hermetic/sample-data/:type | Get sample for entity type |

## Data Buckets

Data buckets in `mockoon/data-buckets.json` provide initial test data. Customize these to match your test scenarios:

```json
{
  "users": [
    { "id": "user-001", "name": "John Doe", "email": "john@example.com" }
  ],
  "orders": [
    { "id": "order-001", "userId": "user-001", "status": "pending" }
  ]
}
```

## Customization

### Adding New Routes

1. Edit `mockoon/environment.json`
2. Add new route object to the `routes` array
3. Restart the container

### Modifying Data

1. Edit `mockoon/data-buckets.json`
2. Update the data in `mockoon/environment.json` data array
3. Restart the container

### Using Mockoon Desktop

1. Download [Mockoon](https://mockoon.com/download/)
2. Import `mockoon/environment.json`
3. Edit routes and data visually
4. Export updated environment

## Testing Examples

```bash
# Get all users
curl http://localhost:8080/api/users

# Get user by ID
curl http://localhost:8080/api/users/user-001

# Create new order
curl -X POST http://localhost:8080/api/orders \
  -H "Content-Type: application/json" \
  -d '{"userId": "user-001", "items": [{"productId": "product-001", "qty": 2}]}'

# Seed test data
curl -X POST http://localhost:8080/hermetic/seedEntities \
  -H "Content-Type: application/json" \
  -d '{"entities": [{"entityId": "test-1", "entityType": "User", "entityValue": {"name": "Test"}}]}'

# Reset server
curl -X POST http://localhost:8080/hermetic/reset
```

## Comparison: Code Change vs Mockoon

| Feature | Code Change | Mockoon |
|---------|-------------|---------|
| Setup Complexity | Medium | Low |
| Customization | Full | Limited |
| Performance | Fast | Very Fast |
| State Management | Full | Session-based |
| Best For | Complex services | Simple APIs |

## Generated by TARS
Test Automation and Review System
